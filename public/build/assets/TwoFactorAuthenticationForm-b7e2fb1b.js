import{_ as G}from"./ActionSection-12a825e8.js";import{_ as O}from"./DangerButton-a8aae548.js";import{_ as M}from"./SecondaryButton-4543e8b6.js";import{_ as W}from"./DialogModal-8e017b22.js";import{_ as E}from"./PrimaryButton-5ed47bb8.js";import{_ as L,a as q}from"./TextInput-f9dcb244.js";import{A as _,r as z,K as o,B as a,G as i,M as J,J as n,a0 as s,S as r,T,F as e,aC as D,a2 as b,ab as j,a7 as X,c as Z,al as ee,a4 as te,U as w,W as u,Q as oe,R as se,a8 as I}from"./iconify-4eda29ca.js";import{_ as ae}from"./InputLabel-4f44e400.js";import"./SectionTitle-9666e716.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-d90e4256.js";const ne={class:"mt-4"},re={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(v,{emit:k}){const l=_(!1),t=z({password:"",error:"",processing:!1}),d=_(null),h=()=>{axios.get(route("password.confirmation")).then(c=>{c.data.confirmed?k("confirmed"):(l.value=!0,setTimeout(()=>d.value.focus(),250))})},y=()=>{t.processing=!0,axios.post(route("password.confirm"),{password:t.password}).then(()=>{t.processing=!1,m(),j().then(()=>k("confirmed"))}).catch(c=>{t.processing=!1,t.error=c.response.data.errors.password[0],d.value.focus()})},m=()=>{l.value=!1,t.password="",t.error=""};return(c,p)=>{const F=L,B=q,K=M,x=E,C=W;return o(),a("span",null,[i("span",{onClick:h},[J(c.$slots,"default")]),n(C,{show:e(l),onClose:m},{title:s(()=>[r(T(v.title),1)]),content:s(()=>[r(T(v.content)+" ",1),i("div",ne,[n(F,{ref_key:"passwordInput",ref:d,modelValue:e(t).password,"onUpdate:modelValue":p[0]||(p[0]=P=>e(t).password=P),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:D(y,["enter"])},null,8,["modelValue","onKeyup"]),n(B,{message:e(t).error,class:"mt-2"},null,8,["message"])])]),footer:s(()=>[n(K,{onClick:m},{default:s(()=>[r(" Cancel ")]),_:1}),n(x,{class:b(["ml-3",{"opacity-25":e(t).processing}]),disabled:e(t).processing,onClick:y},{default:s(()=>[r(T(v.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])])}}},ce={key:0,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ie={key:1,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},le={key:2,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},de=i("div",{class:"mt-3 max-w-xl text-sm text-gray-600 dark:text-gray-400"},[i("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),ue={key:3},me={key:0},pe={class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},fe={key:0,class:"font-semibold"},_e={key:1},ye=["innerHTML"],he={key:0,class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},ge={class:"font-semibold"},we=["innerHTML"],ve={key:1,class:"mt-4"},xe={key:1},be=i("div",{class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},[i("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),ke={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 dark:bg-gray-900 rounded-lg"},Ce={class:"mt-5"},Se={key:0},Te={key:1},Le={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(v){const k=v,l=_(!1),t=_(!1),d=_(!1),h=_(null),y=_(null),m=_([]),c=X({code:""}),p=Z(()=>{var f;return!l.value&&((f=ee().props.auth.user)==null?void 0:f.two_factor_enabled)});te(p,()=>{p.value||(c.reset(),c.clearErrors())});const F=()=>{l.value=!0,I.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([B(),K(),x()]),onFinish:()=>{l.value=!1,t.value=k.requiresConfirmation}})},B=()=>axios.get(route("two-factor.qr-code")).then(f=>{h.value=f.data.svg}),K=()=>axios.get(route("two-factor.secret-key")).then(f=>{y.value=f.data.secretKey}),x=()=>axios.get(route("two-factor.recovery-codes")).then(f=>{m.value=f.data}),C=()=>{c.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{t.value=!1,h.value=null,y.value=null}})},P=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>x())},A=()=>{d.value=!0,I.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{d.value=!1,t.value=!1}})};return(f,V)=>{const H=ae,N=L,Q=q,R=E,g=re,$=M,U=O,Y=G;return o(),w(Y,null,{title:s(()=>[r(" Two Factor Authentication ")]),description:s(()=>[r(" Add additional security to your account using two factor authentication. ")]),content:s(()=>[e(p)&&!e(t)?(o(),a("h3",ce," You have enabled two factor authentication. ")):e(p)&&e(t)?(o(),a("h3",ie," Finish enabling two factor authentication. ")):(o(),a("h3",le," You have not enabled two factor authentication. ")),de,e(p)?(o(),a("div",ue,[e(h)?(o(),a("div",me,[i("div",pe,[e(t)?(o(),a("p",fe," To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code. ")):(o(),a("p",_e," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application or enter the setup key. "))]),i("div",{class:"mt-4 p-2 inline-block bg-base-100",innerHTML:e(h)},null,8,ye),e(y)?(o(),a("div",he,[i("p",ge,[r(" Setup Key: "),i("span",{innerHTML:e(y)},null,8,we)])])):u("",!0),e(t)?(o(),a("div",ve,[n(H,{for:"code",value:"Code"}),n(N,{id:"code",modelValue:e(c).code,"onUpdate:modelValue":V[0]||(V[0]=S=>e(c).code=S),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:D(C,["enter"])},null,8,["modelValue","onKeyup"]),n(Q,{message:e(c).errors.code,class:"mt-2"},null,8,["message"])])):u("",!0)])):u("",!0),e(m).length>0&&!e(t)?(o(),a("div",xe,[be,i("div",ke,[(o(!0),a(oe,null,se(e(m),S=>(o(),a("div",{key:S},T(S),1))),128))])])):u("",!0)])):u("",!0),i("div",Ce,[e(p)?(o(),a("div",Te,[n(g,{onConfirmed:C},{default:s(()=>[e(t)?(o(),w(R,{key:0,type:"button",class:b(["mr-3",{"opacity-25":e(l)}]),disabled:e(l)},{default:s(()=>[r(" Confirm ")]),_:1},8,["class","disabled"])):u("",!0)]),_:1}),n(g,{onConfirmed:P},{default:s(()=>[e(m).length>0&&!e(t)?(o(),w($,{key:0,class:"mr-3"},{default:s(()=>[r(" Regenerate Recovery Codes ")]),_:1})):u("",!0)]),_:1}),n(g,{onConfirmed:x},{default:s(()=>[e(m).length===0&&!e(t)?(o(),w($,{key:0,class:"mr-3"},{default:s(()=>[r(" Show Recovery Codes ")]),_:1})):u("",!0)]),_:1}),n(g,{onConfirmed:A},{default:s(()=>[e(t)?(o(),w($,{key:0,class:b({"opacity-25":e(d)}),disabled:e(d)},{default:s(()=>[r(" Cancel ")]),_:1},8,["class","disabled"])):u("",!0)]),_:1}),n(g,{onConfirmed:A},{default:s(()=>[e(t)?u("",!0):(o(),w(U,{key:0,class:b({"opacity-25":e(d)}),disabled:e(d)},{default:s(()=>[r(" Disable ")]),_:1},8,["class","disabled"]))]),_:1})])):(o(),a("div",Se,[n(g,{onConfirmed:F},{default:s(()=>[n(R,{type:"button",class:b({"opacity-25":e(l)}),disabled:e(l)},{default:s(()=>[r(" Enable ")]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1})}}};export{Le as default};
