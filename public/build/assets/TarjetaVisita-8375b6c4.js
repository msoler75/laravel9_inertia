import{_ as K}from"./Spinner-244d9358.js";import{_ as W}from"./ActionButton-cb21c013.js";import{_ as q}from"./Back-8e73843f.js";import{al as H,A as g,c as D,a5 as J,a4 as N,aa as Y,K as x,B as S,G as e,J as T,a0 as F,S as d,F as n,a1 as z,C as v,D as A,aG as G,H as P,U as Q,W as X,ai as Z,aj as ee}from"./iconify-4eda29ca.js";import{A as ae}from"./AppLayout-4e2e665e.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./Link-4da1af55.js";import"./app-e58faad5.js";import"./permisos-8284c4c1.js";import"./Dropdown-f2c8405d.js";import"./Avatar-677e03a7.js";import"./Modal-d90e4256.js";import"./Image-e6d08a0a.js";import"./index-b7a54f6a.js";const oe=function(l,m){var s={a:"á|à|ã|â",e:"é|è|ê",i:"í|ì|î",o:"ó|ò|ô|õ",u:"ú|ù|û|ü",A:"À|Á|Ã|Â",E:"É|È|Ê",I:"Í|Ì|Î",O:"Ó|Ò|Ô|Õ",U:"Ú|Ù|Û|Ü"},p={c:"ç",n:"ñ",C:"Ç",N:"Ñ"};for(var f in s)l=l.replace(new RegExp(s[f],"g"),f);if(m)for(var f in p)l=l.replace(new RegExp(p[f],"g"),f);return l},ne=function(l){for(var m=l.split(" "),s=0;s<m.length;s++){var p=m[s].charAt(0).toUpperCase();m[s]=p+m[s].substr(1).toLowerCase()}return m.join(" ")},E=function(l){return l.charAt(0).toUpperCase()+l.slice(1)};const y=l=>(Z("data-v-bc583311"),l=l(),ee(),l),le={class:"container mx-auto py-12"},se={class:"container mx-auto flex justify-between items-center mb-7"},re=y(()=>e("h1",{class:"text-center"},"Diseñador de Tarjeta de Visita",-1)),ie=y(()=>e("p",{class:"text-center"},"Rellena tus datos y se generará una tarjeta en formato imagen, que se enviará a tu correo electrónico.",-1)),ce={class:"w-full max-w-screen-md mx-auto flex flex-wrap justify-between gap-12 my-12"},ue={key:0,class:"w-1/2 flex flex-col gap-5"},pe={class:"alert alert-success"},de=y(()=>e("span",null,"Se ha generado la tarjeta y se ha enviado a tu correo.",-1)),me={class:"alert alert-warning"},fe=y(()=>e("span",null,'Revisa tu bandeja de correo. Si no ves ningún mensaje, verifica el correo "spam" o carpeta de "correos no deseados".',-1)),ve={class:"alert"},_e=y(()=>e("span",null,"Ahora puedes consultar acerca de los correos @tseyor.org",-1)),he=["onSubmit"],ge={class:"flex gap-4 justify-center"},xe={class:"flex justify-center pt-5"},ye=["disabled"],be={key:1},we={key:2},je=y(()=>e("h3",null,"Vista previa:",-1)),Ce="/almacen/medios/muul/tarjeta",Ve=Object.assign({layout:ae},{__name:"TarjetaVisita",setup(l){var B;const s=(B=H().props.auth)==null?void 0:B.user,p=g(null),f=g(null),o=g({nombre:s==null?void 0:s.name,cargo:"",correo:s==null?void 0:s.email,telefono:"",ciudad:"",pais:""}),r=g(1),U=D(()=>ne(o.value.nombre.replace(/^\s+|\s+$/g,"").toLowerCase()).replace(/\s+/g," ")),R=D(()=>oe(U.value.toLowerCase(),!0).replace(/\bpm\s*$/,".pm").replace(/la\s+\.pm/,".la.pm").replace(/\s+/g,"")+"@tseyor.org");function k(c){console.log("generarDiseño",p.value),typeof c!="function"&&(c=null);const a=c?f.value:p.value;if(!a.getContext)return;c&&(a.width=1441,a.height=2150);var i=a.width,u=a.height,w=a.height/50,j=.86*i;const t=a.getContext("2d"),C=new Image;t.clearRect(0,0,a.width,a.height),C.src=Ce+"/tarjeta_2019_plantilla"+r.value+"."+(c?"png":"thumb.jpg"),C.onload=function(){C.width/C.height,t.drawImage(C,0,0,i,u),t.fillStyle="rgb(0, 0, 0)",t.textAlign="center";var V=U.value;V&&(t.font="bold "+Math.round(2.5*w)+"pt Palatino, Georgia, Arial, serif",V.length<12&&(V=V.split("").join(String.fromCharCode(8202))),t.fillText(V,i/2,(r.value==1?.37:.47)*u,j)),o.value.cargo&&(t.font="italic "+Math.round(1*w)+"pt Calibri",t.fillText(E(o.value.cargo),i/2,(r.value==1?.43:.52)*u,j)),t.font=Math.round(1*w)+"pt Calibri, serif",t.fillStyle=r.value==1?"#fff":"#0f409d";const _=[];var h=[];o.value.ciudad&&h.push(E(o.value.ciudad)),o.value.pais&&h.push(E(o.value.pais)),h=h.join(" - "),h&&_.push(h),o.value.correo&&_.push(R.value),o.value.telefono&&_.push(o.value.telefono);var M=(r.value==1?.525:.62)+(3-_.length)*(r.value==1?.024:.021),O=.04;for(var $ in _)t.fillText(_[$],i/2,M*u,j),M+=O;c&&c()}}J(()=>{k(),N(()=>o,k,{deep:!0}),N(r,k)});const I=g(!1),b=g(!1);function L(){b.value=!0;const c=p.value;k(()=>{c.toBlob(function(a){const i=new FormData;i.append("nombre_tseyor",U.value),i.append("email_tseyor",R.value),i.append("imagen",a,"tarjeta.jpg"),axios.post(route("tarjeta.visita.enviar"),i).then(u=>{console.log(u),I.value=!0,b.value=!1})})})}return(c,a)=>{const i=q,u=Y("Icon"),w=W,j=K;return x(),S("div",le,[e("div",se,[T(i,{href:"/muul"},{default:F(()=>[d("Espacio Muul")]),_:1})]),re,ie,e("div",ce,[n(I)?(x(),S("div",ue,[e("div",pe,[T(u,{icon:"ph:check-circle-bold",class:"text-2xl"}),de]),e("div",me,[T(u,{icon:"ph:info-bold",class:"text-2xl text-neutral"}),fe]),e("div",ve,[T(u,{icon:"ph:info-bold",class:"text-2xl text-neutral"}),_e]),T(w,{href:"/muul/correos.tseyor"},{default:F(()=>[d("Correos @tseyor.org")]),_:1})])):(x(),S("form",{key:1,class:"flex flex-col bg-base-300 px-12 py-5 rounded-xl",onSubmit:z(L,["prevent"])},[e("label",null,[d("Nombre Simbólico TSEYOR"),v(e("input",{name:"nombre",type:"text","onUpdate:modelValue":a[0]||(a[0]=t=>n(o).nombre=t),placeholder:"Nombre Simbólico de Tseyor"},null,512),[[A,n(o).nombre]])]),e("label",null,[d("Cargo/Función/Rol "),v(e("input",{name:"cargo",type:"text","onUpdate:modelValue":a[1]||(a[1]=t=>n(o).cargo=t),placeholder:"Cargo en Tseyor"},null,512),[[A,n(o).cargo]])]),e("label",null,[d("Teléfono "),v(e("input",{name:"telefono",type:"text","onUpdate:modelValue":a[2]||(a[2]=t=>n(o).telefono=t),placeholder:"Teléfono"},null,512),[[A,n(o).telefono]])]),e("label",null,[d("Ciudad "),v(e("input",{name:"ciudad",type:"text","onUpdate:modelValue":a[3]||(a[3]=t=>n(o).ciudad=t),placeholder:"Ciudad de residencia"},null,512),[[A,n(o).ciudad]])]),e("label",null,[d("País "),v(e("input",{name:"pais",type:"text","onUpdate:modelValue":a[4]||(a[4]=t=>n(o).pais=t),placeholder:"País de residencia"},null,512),[[A,n(o).pais]])]),e("div",ge,[e("label",null,[d("Plantilla 1 "),v(e("input",{name:"diseno",type:"radio",value:"1","onUpdate:modelValue":a[5]||(a[5]=t=>P(r)?r.value=t:null)},null,512),[[G,n(r)]])]),e("label",null,[d("Plantilla 2 "),v(e("input",{name:"diseno",type:"radio",value:"2","onUpdate:modelValue":a[6]||(a[6]=t=>P(r)?r.value=t:null)},null,512),[[G,n(r)]])])]),e("div",xe,[e("button",{class:"btn btn-primary flex gap-2 items-center",type:"submit",value:"Generar y Enviar",disabled:n(b)},[n(b)?(x(),Q(j,{key:0})):X("",!0),n(b)?(x(),S("span",be,"Enviando")):(x(),S("span",we,"Generar y Enviar"))],8,ye)])],40,he)),e("div",null,[je,e("canvas",{class:"shadow-xl",ref_key:"preview",ref:p,width:"300",height:"450"},null,512)])]),e("canvas",{class:"hidden",ref_key:"render",ref:f},null,512)])}}}),Pe=te(Ve,[["__scopeId","data-v-bc583311"]]);export{Pe as default};
