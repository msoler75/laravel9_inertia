import{_ as Y}from"./Sections-9f6b412c.js";import{_ as z}from"./ConfirmationModal-570bb728.js";import{_ as I}from"./TimeAgo-d7658970.js";import{_ as X}from"./Section-a689248d.js";import{_ as Z}from"./Link-906724b9.js";import{_ as ee}from"./Avatar-677e03a7.js";import{_ as te}from"./AdminPanel-c9b93513.js";import{_ as oe}from"./Back-f6a5b732.js";import{al as ae,c as g,A as b,K as t,B as a,G as o,J as l,a0 as c,S as y,F as n,W as m,T as p,Q as q,R as E,a1 as h,C as j,D as se,H as B,U as ie,ah as ne,a8 as re}from"./iconify-4eda29ca.js";import{A as ue}from"./AppLayout-78f8ede6.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-d90e4256.js";import"./app-6a98c07f.js";import"./Image-e6d08a0a.js";import"./permisos-625d1cf9.js";import"./Dropdown-f2c8405d.js";import"./Spinner-244d9358.js";import"./index-b7a54f6a.js";const le={class:"pt-8"},ce={class:"container mx-auto flex justify-between items-center mb-20"},de=o("span",null,null,-1),me={key:0,class:"flex justify-center my-2"},pe={class:"text-center my-2"},fe={class:"my-2 flex flex-wrap gap-3"},_e={class:"prose my-7"},be=["onSubmit"],ve={key:1},ge={key:2,class:"w-full flex justify-center gap-4"},ye={class:"flex flex-wrap justify-center gap-5"},he=["onClick"],xe={key:1,class:"mt-7"},ke=["onSubmit"],qe=["value"],Ee=["disabled"],we={class:"mx-auto xl:max-w-xl px-4"},Ce=o("h2",{class:"text-center"},"Últimos comentarios",-1),Se={class:"list-none space-y-5"},Ae={class:"w-full flex flex-col gap-3 md:flex-row justify-between items-baseline"},Fe=["onSubmit"],$e=o("button",{type:"submit",class:"btn btn-primary"}," Eliminar ",-1),Ie=Object.assign({layout:ue},{__name:"Usuario",props:{usuario:{type:Object,required:!0},comentarios:{type:Array,required:!0},administrar:{type:Boolean,default:!1},equipos:{type:Array,default:[]}},setup(u){const i=u,w=ae().props.auth.user,$=g(()=>i.equipos.filter(s=>!i.usuario.equipos.find(r=>r.id==s.id))),V=g(()=>i.usuario.grupos.filter(s=>!i.usuario.equipos.find(r=>r.group_id==s.id))),N=g(()=>(w==null?void 0:w.id)==i.usuario.id),x=g(()=>i.usuario.avatar||i.usuario.profile_photo_url||i.usuario.imagen);g(()=>x.value?x.value.match(/^https?:\/\//)?x.value:"/storage/"+x.value:"/almacen/profile-photos/user.png");const f=b(i.usuario.frase),d=b(!1),v=b(!1),k=b(null),_=b(null),C=b(null);function M(s){k.value=s,v.value=!0}function T(){console.log("eliminar Equipo",k.value,"user:",i.usuario.id),v.value=!1,axios.put(route("equipo.remover",{idEquipo:k.value.id,idUsuario:i.usuario.id})).then(s=>{S()}).catch(s=>{console.log({err:s}),C.value="No se ha podido remover el equipo."})}function S(){re.reload({only:["usuario"]})}function D(){console.log("agregar Equipo",{idEquipo:_.value,idUsuario:i.usuario.id}),axios.put(route("equipo.agregar",{idEquipo:_.value,idUsuario:i.usuario.id})).then(s=>{S()}).catch(s=>{console.log({err:s}),C.value="No se ha podido agregar el equipo."})}function G(){f.value=i.usuario.frase,d.value=!0}function A(){axios.put(route("usuario.guardar",i.usuario.id),{frase:f.value}).then(s=>{S(),d.value=!1}).catch(s=>{console.log({err:s}),C.value="No se ha podido editar la frase."})}function L(){f.value="",A()}function O(){d.value=!1}function K(){d.value&&A()}return(s,r)=>{const Q=oe,R=te,H=ee,F=Z,U=X,J=I,P=z,W=Y;return t(),a("div",le,[o("div",ce,[l(Q,null,{default:c(()=>[y("Usuarios")]),_:1}),de,l(R,{modelo:"user",necesita:"administrar usuarios",contenido:u.usuario},null,8,["contenido"])]),l(W,null,{default:c(()=>[l(U,{class:"mx-auto flex flex-col items-center py-20"},{default:c(()=>[l(H,{big:"",link:!1,user:u.usuario},null,8,["user"]),n(N)?(t(),a("div",me,[l(F,{class:"btn btn-xs btn-primary",href:"/user/profile"},{default:c(()=>[y("cambiar imagen")]),_:1})])):m("",!0),o("h1",pe,p(u.usuario.name||u.usuario.slug),1),o("div",fe,[(t(!0),a(q,null,E(n(V),e=>(t(),a("div",{class:"badge",key:e.id},p(e.nombre),1))),128))]),o("div",_e,[o("form",{onSubmit:h(K,["prevent"])},[n(d)?j((t(),a("textarea",{key:0,class:"w-full max-w-full",cols:"160","onUpdate:modelValue":r[0]||(r[0]=e=>B(f)?f.value=e:null)},null,512)),[[se,n(f)]]):(t(),a("blockquote",ve,[o("p",null,p(u.usuario.frase),1)])),n(N)?(t(),a("div",ge,[n(d)?m("",!0):(t(),a("button",{key:0,class:"btn btn-primary btn-xs",onClick:G},"Editar frase")),n(d)?m("",!0):(t(),a("button",{key:1,class:"btn btn-primary btn-xs",onClick:L},"Generar frase")),n(d)?(t(),a("button",{key:2,type:"submit",class:"btn btn-primary btn-xs",onClick:A},"Guardar")):m("",!0),n(d)?(t(),a("button",{key:3,class:"btn btn-error btn-xs",onClick:O},"Cancelar")):m("",!0)])):m("",!0)],40,be)]),o("div",ye,[(t(!0),a(q,null,E(u.usuario.equipos,e=>(t(),ie(F,{class:"badge badge-neutral gap-2",key:e.id,href:s.route("equipo",e.slug||e.id)},{default:c(()=>[u.administrar?(t(),a("span",{key:0,onClick:h(Ue=>M(e),["prevent"])},"x",8,he)):m("",!0),y(" "+p(e.nombre),1)]),_:2},1032,["href"]))),128))]),u.administrar&&n($).length?(t(),a("div",xe,[o("form",{onSubmit:h(D,["prevent"]),class:"flex gap-3"},[j(o("select",{"onUpdate:modelValue":r[1]||(r[1]=e=>B(_)?_.value=e:null),placeholder:"Elige un equipo...",class:"text-gray-900"},[(t(!0),a(q,null,E(n($),e=>(t(),a("option",{key:e.id,value:e.id},p(e.nombre),9,qe))),128))],512),[[ne,n(_)]]),o("input",{type:"submit",class:"btn btn-primary",value:"Agregar Equipo",disabled:!n(_)},null,8,Ee)],40,ke)])):m("",!0)]),_:1}),l(U,{class:"py-20"},{default:c(()=>[o("div",we,[Ce,o("ul",Se,[(t(!0),a(q,null,E(u.comentarios,e=>(t(),a("li",Ae,[l(F,{href:e.url,class:"prose"},{default:c(()=>[o("blockquote",null,[o("p",null,p(e.texto),1)])]),_:2},1032,["href"]),l(J,{date:e.created_at,class:"text-sm"},null,8,["date"])]))),256))])])]),_:1}),l(P,{show:n(v),onClose:r[3]||(r[3]=e=>v.value=!1)},{title:c(()=>[y(" Confirmación de eliminación ")]),content:c(()=>[y(" ¿Quieres eliminar "+p(n(k).nombre)+" de este usuario? ",1)]),footer:c(()=>[o("form",{class:"w-full space-x-4",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline",onSubmit:h(T,["prevent"])},[o("button",{onClick:r[2]||(r[2]=h(e=>v.value=!1,["prevent"])),type:"button",class:"btn btn-secondary"}," Cancelar "),$e],40,Fe)]),_:1},8,["show"])]),_:1})])}}});export{Ie as default};
