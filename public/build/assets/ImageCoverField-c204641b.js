import{_ as I}from"./Modal-d90e4256.js";import{A as d,a4 as y,al as z,aa as C,K as x,B as _,J as h,a0 as V,G as i,F as c,T as $,a1 as D,c as M,a5 as B,am as U,C as q,D as A,H as k,Q as E,R as P,a2 as R}from"./iconify-4eda29ca.js";import{v as T}from"./FolderExplorer-c0faf4a6.js";const j={class:"inline"},K={class:"p-5 flex flex-col gap-5 items-center"},N={class:"flex flex-col items-center"},O={__name:"ModalDropZone",props:{url:String,modelValue:{type:Boolean},placeholder:{type:String,default:"Arrastra el archivo aquí o haz clic"},mediaFolder:String,options:Object},emits:["update:modelValue","uploaded"],setup(p,{emit:b}){const s=p,e=d(s.modelValue);y(e,r=>{b("update:modelValue",r)}),y(()=>s.modelValue,r=>{e.value=r});const v=z(),f=d({url:s.url,thumbnailWidth:150,maxFilesize:50,multiple:!1,headers:{"X-CSRF-Token":v.props?v.props.csrf_token:document.querySelector('meta[name="csrf-token"]').content},...s.options});function l(r,o,m){m.append("destinationPath",s.mediaFolder||"")}function g(r,o){o.data.filePath&&b("uploaded",o.data.filePath)}return(r,o)=>{const m=C("Icon"),u=I;return x(),_("div",j,[h(u,{show:c(e),onClose:o[1]||(o[1]=S=>e.value=!1)},{default:V(()=>[i("div",K,[h(c(T),{class:"w-full !hover:bg-orange-200 dark:hover:bg-orange-900 hover:border-orange-500 cursor-pointer",id:"dropzone",options:c(f),useCustomSlot:!0,onVdropzoneSending:l,onVdropzoneSuccess:g},{default:V(()=>[i("div",N,[h(m,{icon:"mdi:cloud-upload-outline",class:"text-5xl"}),i("span",null,$(p.placeholder),1)])]),_:1},8,["options"]),i("button",{onClick:o[0]||(o[0]=D(S=>e.value=!1,["prevent"])),type:"button",class:"btn btn-neutral"}," Cerrar ")])]),_:1},8,["show"])])}}},Z=["name"],G={class:"flex overflow-x-auto"},H=["title","onClick"],J=["src"],Y={__name:"ImageCoverField",props:{from:String,name:String,folder:String,value:String},emits:"selected",setup(p,{emit:b}){const s=p,e=d([]),v=d([]),f=d([]),l=d(s.value);M(()=>e.value.map(t=>t));var g=null;function r(){if(e.value.splice(0,e.value.length),o&&o.value!=g){g=o.value,console.log("texto from cambió!");const t=/!\[.*?\]\((.*?)\)|<img[^>]+src=["']?([^"']+)["']?/g;f.value=[];let a;for(;(a=t.exec(g))!==null;)f.value.push(a[1]?a[1]:a[2])}for(const t of v.value)e.value.push(t);s.value&&e.value.push(s.value);for(const t of f.value)e.value.push(t);l.value&&e.value.push(l.value),e.value=[...new Set(e.value)],!l.value&&e.value.length&&(l.value=e.value[0])}var o=null,m=null;B(()=>{o=document.querySelector("[name='"+s.from+"']"),m=setInterval(r,1e3),r()}),U(()=>{clearInterval(m)});const u=d(!1);function S(t){v.value.push(t),e.value.push(t),u.value=!1,l.value=t}return(t,a)=>{const F=O,w=C("Icon");return x(),_("div",null,[q(i("input",{type:"text",name:p.name,"onUpdate:modelValue":a[0]||(a[0]=n=>k(l)?l.value=n:null),class:"w-[600px]"},null,8,Z),[[A,c(l)]]),h(F,{modelValue:c(u),"onUpdate:modelValue":a[1]||(a[1]=n=>k(u)?u.value=n:null),onUploaded:a[2]||(a[2]=n=>S(n)),placeholder:"Arrastra la imagen aquí o haz clic",url:"/files/upload/image",mediaFolder:p.folder,options:{maxFiles:1,acceptedFiles:"image/*"}},null,8,["modelValue","mediaFolder"]),i("div",G,[(x(!0),_(E,null,P(c(e),n=>(x(),_("div",{key:n,class:R(["border-4 border-transparent flex-shrink-0 cursor-pointer",n==c(l)?"!border-orange-500":""]),title:n,onClick:L=>l.value=n},[i("img",{src:n+"?mh=150",style:{height:"150px"}},null,8,J)],10,H))),128)),i("div",{onClick:a[3]||(a[3]=n=>u.value=!0),title:"Añadir una imagen",class:"flex justify-center items-center w-[150px] h-[150px] border-gray-700 dark:border-gray-300 border opacity-80 hover:opacity-100 bg-gray-500 cursor-pointer flex-shrink-0"},[h(w,{icon:"ic:outline-add-photo-alternate",class:"text-4xl"})])])])}}};export{Y as _};
