import{_ as S}from"./FolderExplorer-5ca1c300.js";import{_ as D}from"./Modal-d90e4256.js";import{A as l,a5 as N,aa as U,U as V,a0 as p,F as s,K as _,J as b,G as a,T as w,a1 as c,B as W,W as q,S as P}from"./iconify-4eda29ca.js";import{u as T}from"./permisos-8284c4c1.js";const G={class:"bg-base-100 p-3"},H={class:"p-8"},J={class:"flex pt-3 justify-between sm:justify-end gap-3 flex-shrink-0"},K=["onClick"],L={class:"bg-base-100 p-3"},z=["src"],O={class:"flex pt-3 justify-between sm:justify-end gap-3 flex-shrink-0"},Q=["onClick"],R=["onClick"],oe={__name:"FileManager",props:{ruta:{type:String,required:!1,default:""},modoInsertar:{type:Boolean,default:!1},contentClass:String,mostrarMisArchivos:{type:[Boolean,String],default:!0}},emits:["image"],setup(t,{emit:C}){const g=t,h=T(),u=l(!0),y=l([{ruta:g.ruta}]),k=l(!1),x=l(null),d=l("/"+g.ruta);function m(){u.value=!0,console.log("loadFolder",d.value),axios.get("/filemanager"+d.value).then(e=>{console.log("response",e),y.value=e.data.items,k.value=e.data.puedeEscribir,x.value=e.data.propietario,u.value=!1}).catch(e=>{var v;u.value=!1,console.log(e);const o=(v=e.response)==null?void 0:v.data,i=o==null?void 0:o.message;alert(i||"Hubo un error al cargar la carpeta")})}N(()=>{m()});function A(){m()}function M(e){console.log("disk change to",e),d.value="/"+e.ruta,m()}function F(e){console.log("folder change to",e),d.value="/"+e.ruta,m()}const n=l(null),r=l(null);function I(e){console.log("file clicked",e),e.url.match(/\.(gif|png|webp|svg|jpe?g)$/i)?n.value=e:h.isPlayable(e.url)?h.play(e.url,e.nombre):r.value=e}function B(){console.log("insertarImagen",n.value),C("image",n.value.url),n.value=null}function j(){window.open(n.value.url,"_blank")}function E(){window.open(r.value.url,"_blank"),r.value=!1}return(e,o)=>{const i=D,v=U("Icon"),$=S;return _(),V($,{items:s(y),puedeEscribir:s(k),propietario:s(x),onUpdated:A,onDisk:M,onFolder:F,onFile:I,embed:!0,ruta:t.ruta,rutaBase:"",cargando:s(u),rootLabel:"web:",rootUrl:"",mostrarMisArchivos:t.mostrarMisArchivos!==!1&&t.mostrarMisArchivos!=="false"&&t.mostrarMisArchivos!=="0"&&t.mostrarMisArchivos!=="no"||["true","1","si"].includes(t.mostrarMisArchivos)||t.mostrarMisArchivos===!0},{default:p(()=>[b(i,{show:s(r),onClose:o[1]||(o[1]=f=>r.value=null),maxWidth:"xl"},{default:p(()=>[a("div",G,[a("div",H,w(s(r).nombre),1),a("div",J,[a("button",{onClick:c(E,["prevent"]),type:"button",class:"btn btn-secondary"}," Descargar ",8,K),a("button",{onClick:o[0]||(o[0]=c(f=>r.value=null,["prevent"])),type:"button",class:"btn btn-neutral"}," Cancelar ")])])]),_:1},8,["show"]),b(i,{show:s(n),onClose:o[3]||(o[3]=f=>n.value=null),maxWidth:"xl"},{default:p(()=>[a("div",L,[a("img",{src:s(n).url+"?mw=700&mh=600",class:"w-full max-h-[calc(100vh-170px)] object-contain"},null,8,z),a("div",O,[t.modoInsertar?(_(),W("button",{key:0,onClick:c(B,["prevent"]),type:"button",class:"btn btn-primary"}," Insertar ",8,Q)):q("",!0),a("button",{onClick:c(j,["prevent"]),type:"button",class:"btn btn-secondary flex gap-2 items-center"},[b(v,{icon:"ph:arrow-square-out-duotone",class:"text-xl"}),P(" Abrir ")],8,R),a("button",{onClick:o[2]||(o[2]=c(f=>n.value=null,["prevent"])),type:"button",class:"btn btn-neutral"},w(t.modoInsertar?"Cancelar":"Cerrar"),1)])])]),_:1},8,["show"])]),_:1},8,["items","puedeEscribir","propietario","ruta","cargando","mostrarMisArchivos"])}}};export{oe as _};
