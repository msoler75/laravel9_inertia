import{c as g,aa as B,K as f,U as v,a0 as b,B as x,Q as C,R as M,O as E,X as A,V as F,F as k,S as L,T as S,A as N,a5 as D,_ as $,ab as O,J as V}from"./iconify-4eda29ca.js";import{_ as z}from"./Prose-dc9a327e.js";import{_ as R}from"./Image-e6d08a0a.js";import{_ as j}from"./Referencia-e2843fe3.js";import{d as q,M as G}from"./markdown-82232cdd.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";const J={__name:"ContentNode",props:{node:Object,useImage:{type:Boolean,default:!0}},setup(a){const t=a,p=g(()=>t.node.tagName=="referencia"?j:t.node.tagName=="img"&&t.useImage?R:t.node.tagName);return(h,i)=>{const u=B("ContentNode",!0);return a.node.tagName?(f(),v(F(k(p)),E(A({key:0},a.node.attributes)),{default:b(()=>[(f(!0),x(C,null,M(a.node.children,_=>(f(),v(u,{node:_,"use-image":a.useImage},null,8,["node","use-image"]))),256))]),_:1},16)):(f(),x(C,{key:1},[L(S(a.node.textContent),1)],64))}}};const K={__name:"Content",props:{content:{type:String,required:!0},format:{type:String,default:""},optimizeImages:{type:Boolean,default:!0}},setup(a){const t=a,p=g(()=>t.format=="md"?!0:["md","ambiguous"].includes(q(t.content).format)),h=N(null),i=N([]);var u=null;const _=g(()=>p.value?G(t.content):t.content?t.content:""),y=g(()=>_.value.replace(/<span class="es-referencia"(.*?)<\/span>/g,"<referencia$1</referencia>"));function w(n){i.value=[];const m=new DOMParser().parseFromString(n,"text/html");function l(e){const d=!e.tagName,c={tagName:d?null:e.tagName.toLowerCase(),textContent:e.textContent};if(!d&&(e.tagName=="IMG"&&(e.setAttribute("image-index",i.value.length),i.value.push(e.src.replace(/\?.*$/,""))),c.attributes={},c.children=[],e.attributes))for(let r=0;r<e.attributes.length;r++){const o=e.attributes[r];c.attributes[o.name]=o.value}for(let r=0;r<e.childNodes.length;r++){const o=e.childNodes[r];o.nodeType===1?c.children.push(l(o)):o.nodeType===3&&o.textContent&&c.children.push({tagName:null,textContent:o.textContent})}return c}return l(m.body.firstChild)}const I=g(()=>w("<div>"+y.value+"</div>"));D(async()=>{await $(()=>import("./v3-img-preview.esm-6137cec3.js"),["assets/v3-img-preview.esm-6137cec3.js","assets/iconify-4eda29ca.js"]).then(n=>{u=n.v3ImgPreviewFn,O(()=>{var s=document.querySelectorAll(".footnote-ref a, a.footnote-backref");console.log({scrollLinks:s}),s.forEach(function(m){m.addEventListener("click",function(l){l.preventDefault(),console.log("clicked!");var e=this.getAttribute("href").substring(1),d=document.getElementById(e);if(d){console.log("got target");var c=90,r=d.getBoundingClientRect(),o=window.scrollY+r.top-c;window.scrollTo({top:o,behavior:"smooth"})}})})})})});function P(n){console.log("clicked",n.target),n.target.tagName=="IMG"&&T(n.target)}function T(n){const s=n.getAttribute("image-index");console.log("clicked ",s,i.value[s]),u&&u({images:i.value,index:s})}return(n,s)=>{const m=J,l=z;return f(),v(l,{ref_key:"container",ref:h,class:"text-container"},{default:b(()=>[V(m,{node:k(I),"use-image":a.optimizeImages,onClick:P},null,8,["node","use-image"])]),_:1},512)}}},ee=H(K,[["__scopeId","data-v-368d159e"]]);export{ee as _};
