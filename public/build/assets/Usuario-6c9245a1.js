import{_ as Y}from"./Sections-9f6b412c.js";import{_ as z}from"./ConfirmationModal-570bb728.js";import{_ as I}from"./TimeAgo-d7658970.js";import{_ as X}from"./Section-a689248d.js";import{_ as Z}from"./Link-4da1af55.js";import{_ as ee}from"./Avatar-677e03a7.js";import{_ as oe}from"./AdminPanel-f80837ef.js";import{_ as te}from"./Back-8e73843f.js";import{al as ae,c as g,A as b,K as t,B as a,G as o,J as u,a0 as c,S as y,F as i,W as m,T as p,Q as q,R as E,a1 as h,C as j,D as se,H as B,U as ne,ah as ie,a8 as re}from"./iconify-4eda29ca.js";import{A as le}from"./AppLayout-4e2e665e.js";import"./permisos-8284c4c1.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-d90e4256.js";import"./app-e58faad5.js";import"./Image-e6d08a0a.js";import"./Dropdown-f2c8405d.js";import"./Spinner-244d9358.js";import"./index-b7a54f6a.js";const ue={class:"pt-8"},ce={class:"container mx-auto flex justify-between items-center mb-20"},de=o("span",null,null,-1),me={key:0,class:"flex justify-center my-2"},pe={class:"text-center my-2"},fe={class:"my-2 flex flex-wrap gap-3"},_e={class:"prose my-7"},be=["onSubmit"],ve={key:1},ge={key:2,class:"w-full flex justify-center gap-4"},ye={class:"flex flex-wrap justify-center gap-5"},he=["onClick"],xe={key:1,class:"mt-7"},ke=["onSubmit"],qe=o("label",null,"Agregarlo al equipo:",-1),Ee=["value"],we=["disabled"],Ce={class:"mx-auto xl:max-w-xl px-4"},Se=o("h2",{class:"text-center"},"Últimos comentarios",-1),Ae={class:"list-none space-y-5"},Fe={class:"w-full flex flex-col gap-3 md:flex-row justify-between items-baseline"},$e=["onSubmit"],Ne=o("button",{type:"submit",class:"btn btn-primary"}," Eliminar ",-1),Xe=Object.assign({layout:le},{__name:"Usuario",props:{usuario:{type:Object,required:!0},comentarios:{type:Array,required:!0},administrar:{type:Boolean,default:!1},equipos:{type:Array,default:[]}},setup(l){const n=l,w=ae().props.auth.user,$=g(()=>n.equipos.filter(s=>!n.usuario.equipos.find(r=>r.id==s.id))),V=g(()=>n.usuario.grupos.filter(s=>!n.usuario.equipos.find(r=>r.group_id==s.id))),N=g(()=>(w==null?void 0:w.id)==n.usuario.id),x=g(()=>n.usuario.avatar||n.usuario.profile_photo_url||n.usuario.imagen);g(()=>x.value?x.value.match(/^https?:\/\//)?x.value:"/storage/"+x.value:"/almacen/profile-photos/user.png");const f=b(n.usuario.frase),d=b(!1),v=b(!1),k=b(null),_=b(null),C=b(null);function M(s){k.value=s,v.value=!0}function T(){console.log("eliminar Equipo",k.value,"user:",n.usuario.id),v.value=!1,axios.put(route("equipo.remover",{idEquipo:k.value.id,idUsuario:n.usuario.id})).then(s=>{S()}).catch(s=>{console.log({err:s}),C.value="No se ha podido remover el equipo."})}function S(){re.reload({only:["usuario"]})}function D(){console.log("agregar Equipo",{idEquipo:_.value,idUsuario:n.usuario.id}),axios.put(route("equipo.agregar",{idEquipo:_.value,idUsuario:n.usuario.id})).then(s=>{S()}).catch(s=>{console.log({err:s}),C.value="No se ha podido agregar el equipo."})}function G(){f.value=n.usuario.frase,d.value=!0}function A(){axios.put(route("usuario.guardar",n.usuario.id),{frase:f.value}).then(s=>{S(),d.value=!1}).catch(s=>{console.log({err:s}),C.value="No se ha podido editar la frase."})}function L(){f.value="",A()}function O(){d.value=!1}function K(){d.value&&A()}return(s,r)=>{const Q=te,R=oe,H=ee,F=Z,U=X,J=I,P=z,W=Y;return t(),a("div",ue,[o("div",ce,[u(Q,null,{default:c(()=>[y("Usuarios")]),_:1}),de,u(R,{modelo:"user",necesita:"administrar usuarios",contenido:l.usuario},null,8,["contenido"])]),u(W,null,{default:c(()=>[u(U,{class:"mx-auto flex flex-col items-center py-20"},{default:c(()=>[u(H,{big:"",link:!1,user:l.usuario},null,8,["user"]),i(N)?(t(),a("div",me,[u(F,{class:"btn btn-xs btn-primary",href:"/user/profile"},{default:c(()=>[y("cambiar imagen")]),_:1})])):m("",!0),o("h1",pe,p(l.usuario.name||l.usuario.slug),1),o("div",fe,[(t(!0),a(q,null,E(i(V),e=>(t(),a("div",{class:"badge",key:e.id},p(e.nombre),1))),128))]),o("div",_e,[o("form",{onSubmit:h(K,["prevent"])},[i(d)?j((t(),a("textarea",{key:0,class:"w-full max-w-full",cols:"160","onUpdate:modelValue":r[0]||(r[0]=e=>B(f)?f.value=e:null)},null,512)),[[se,i(f)]]):(t(),a("blockquote",ve,[o("p",null,p(l.usuario.frase),1)])),i(N)?(t(),a("div",ge,[i(d)?m("",!0):(t(),a("button",{key:0,class:"btn btn-primary btn-xs",onClick:G},"Editar frase")),i(d)?m("",!0):(t(),a("button",{key:1,class:"btn btn-primary btn-xs",onClick:L},"Generar frase")),i(d)?(t(),a("button",{key:2,type:"submit",class:"btn btn-primary btn-xs",onClick:A},"Guardar")):m("",!0),i(d)?(t(),a("button",{key:3,class:"btn btn-error btn-xs",onClick:O},"Cancelar")):m("",!0)])):m("",!0)],40,be)]),o("div",ye,[(t(!0),a(q,null,E(l.usuario.equipos,e=>(t(),ne(F,{class:"badge badge-neutral gap-2",key:e.id,href:s.route("equipo",e.slug||e.id)},{default:c(()=>[l.administrar?(t(),a("span",{key:0,onClick:h(je=>M(e),["prevent"])},"x",8,he)):m("",!0),y(" "+p(e.nombre),1)]),_:2},1032,["href"]))),128))]),l.administrar&&i($).length?(t(),a("div",xe,[o("form",{onSubmit:h(D,["prevent"]),class:"space-y-3"},[qe,j(o("select",{"onUpdate:modelValue":r[1]||(r[1]=e=>B(_)?_.value=e:null),placeholder:"Elige un equipo...",class:"text-gray-900"},[(t(!0),a(q,null,E(i($),e=>(t(),a("option",{key:e.id,value:e.id},p(e.nombre),9,Ee))),128))],512),[[ie,i(_)]]),o("input",{type:"submit",class:"btn btn-primary max-w-5",value:"Agregar al Equipo",disabled:!i(_)},null,8,we)],40,ke)])):m("",!0)]),_:1}),u(U,{class:"py-20"},{default:c(()=>[o("div",Ce,[Se,o("ul",Ae,[(t(!0),a(q,null,E(l.comentarios,e=>(t(),a("li",Fe,[u(F,{href:e.url,class:"prose"},{default:c(()=>[o("blockquote",null,[o("p",null,p(e.texto),1)])]),_:2},1032,["href"]),u(J,{date:e.created_at,class:"text-sm"},null,8,["date"])]))),256))])])]),_:1}),u(P,{show:i(v),onClose:r[3]||(r[3]=e=>v.value=!1)},{title:c(()=>[y(" Confirmación de eliminación ")]),content:c(()=>[y(" ¿Quieres removerlo del equipo '"+p(i(k).nombre)+"'? ",1)]),footer:c(()=>[o("form",{class:"w-full space-x-4",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline",onSubmit:h(T,["prevent"])},[o("button",{onClick:r[2]||(r[2]=h(e=>v.value=!1,["prevent"])),type:"button",class:"btn btn-secondary"}," Cancelar "),Ne],40,$e)]),_:1},8,["show"])]),_:1})])}}});export{Xe as default};
