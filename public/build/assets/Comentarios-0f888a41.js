import{_ as N}from"./Avatar-677e03a7.js";import{al as C,A as h,a5 as R,ab as M,K as a,B as m,J as y,G as t,a1 as S,C as I,D as j,F as n,H as V,aC as E,T as k,W as v,aD as z,aa as F,U as w,$ as G,a9 as L,a0 as T,Q as A,R as B,au as D}from"./iconify-4eda29ca.js";import{_ as U}from"./TimeAgo-d7658970.js";const H={class:"w-full space-y-1 flex-grow flex gap-3"},J={class:"w-full flex flex-col gap-3 mb-3"},O=["onSubmit"],Q=["onKeydown"],W={class:"w-full flex justify-end"},q=["disabled"],P={key:0,class:"alert alert-error"},X=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),K={__name:"ResponderComentario",props:{comentarioId:String|Number,url:String,focus:Boolean},emits:["respondido"],setup(o,{emit:p}){const i=o,f=C().props.auth.user,x=h(null);R(()=>{i.focus&&M(()=>{x.value.focus()})});const e=h(""),u=h(null),c={id:f.id,nombre:f.name,imagen:f.profile_photo_url};function s(){u.value="";const g=e.value;z.post(route("comentario.nuevo"),{url:i.url,respuesta_a:i.comentarioId,texto:e.value}).then(d=>{p("respondido",d.data)}).catch(d=>{u.value="No se ha podido enviar el comentario.",e.value=g}),e.value=""}return(g,d)=>{const b=N;return a(),m("div",H,[y(b,{user:c,class:"w-16 h-16 rounded-full"}),t("div",J,[t("form",{onSubmit:S(s,["prevent"])},[I(t("textarea",{class:"textarea text-rounded-lg w-full","onUpdate:modelValue":d[0]||(d[0]=l=>V(e)?e.value=l:null),placeholder:"Escribe tu comentario...",onKeydown:E(S(s,["ctrl"]),["enter"]),ref_key:"inputText",ref:x},null,40,Q),[[j,n(e)]]),t("div",W,[t("button",{class:"btn btn-primary",onClick:s,disabled:!n(e)},"Enviar",8,q)])],40,O),n(u)?(a(),m("div",P,[X,t("span",null,k(n(u)),1)])):v("",!0)])])}}},Y=["id"],Z={class:"flex-grow"},ee={class:"flex flex-col gap-3 mb-3"},te={class:"flex flex-col gap-1"},oe={class:"card bg-base-100 shadow p-3 gap-3 w-full"},ne={class:"w-full flex justify-between"},se={key:0,class:"pl-3 flex gap-5 text-sm"},ae={__name:"Comentario",props:{comentarioId:String|Number,url:String|Number,autor:Object,texto:String,fecha:Number|String,respuestas:{type:Array,default:()=>[]},profundidad:{type:Number,default:0}},setup(o){const p=o,i=h(!1),r=h(p.respuestas);function f(c){console.log("comentario.nuevaRespuesta",c),c.respuesta_a==p.comentarioId&&(i.value=!1),r.value.unshift({id:Math.random(),autor:u,texto:c.texto,respuesta_a:p.comentarioId,fecha:new Date})}const e=C().props.auth.user,u=e?{id:e.id,nombre:e.name,imagen:e.profile_photo_url}:{id:0,nombre:"",imagen:""};return(c,s)=>{var $;const g=N,d=U,b=K,l=F("Comentario",!0);return a(),m("div",{id:"comentario_"+o.comentarioId,class:"w-full flex gap-3"},[y(g,{user:o.autor},null,8,["user"]),t("div",Z,[t("div",ee,[t("div",te,[t("div",oe,[t("div",ne,[t("strong",null,k(($=o.autor)==null?void 0:$.nombre),1),y(d,{fecha:o.fecha,class:"text-xs"},null,8,["fecha"])]),t("div",null,k(o.texto),1)]),n(e)&&!n(i)?(a(),m("div",se,[t("span",{onClick:s[0]||(s[0]=_=>i.value=!0),class:"cursor-pointer"},"Responder")])):v("",!0)])]),n(e)&&n(i)?(a(),w(b,{class:"my-7",url:o.url,key:o.comentarioId,focus:!0,"comentario-id":o.comentarioId,onRespondido:f},null,8,["url","comentario-id"])):v("",!0),I(t("div",{style:L("--profundidad: "+o.profundidad)},[y(D,{name:"comment"},{default:T(()=>[(a(!0),m(A,null,B(n(r),_=>(a(),w(l,{key:_.id,autor:_.autor,"comentario-id":_.id,url:o.url,fecha:_.created_at,texto:_.texto,respuestas:_.respuestas,profundidad:o.profundidad+1},null,8,["autor","comentario-id","url","fecha","texto","respuestas","profundidad"]))),128))]),_:1})],4),[[G,n(r).length]])])],8,Y)}}};const re={class:"bg-base-200 border-t-2 border-base-3 py-12"},le={class:"container mx-auto space-y-2"},ie={class:"mx-auto sm:max-w-[640px]"},ue=t("h2",{class:"mb-9"},"Comentarios",-1),ce={class:"w-full",style:{"--profundidad":"0"}},de={key:1},_e={__name:"Comentarios",props:{url:{type:String,default(){return window.location.pathname}}},setup(o){var c;const p=o,r=(c=C().props.auth)==null?void 0:c.user,f=r?{id:r.id,nombre:r.name,imagen:r.profile_photo_url}:{id:0,nombre:"",imagen:""};function x(s){console.log("comentarios.nuevoComentario",s),e.value.unshift({id:s.id,autor:f,texto:s.texto,fecha:new Date})}const e=h([]),u=h(!0);return R(()=>{axios.get(route("comentarios")+"?url="+p.url).then(s=>{e.value=s.data.comentarios,u.value=!1})}),(s,g)=>{const d=K,b=ae;return a(),m("div",re,[t("div",le,[t("div",ie,[ue,n(r)?(a(),w(d,{key:0,class:"my-7",url:o.url,onRespondido:x},null,8,["url"])):v("",!0),t("div",ce,[n(e).length?(a(),w(D,{key:0,name:"comment"},{default:T(()=>[(a(!0),m(A,null,B(n(e),l=>(a(),w(b,{key:l.id,autor:l.autor,"comentario-id":l.id,url:o.url,fecha:l.created_at,texto:l.texto,respuestas:l.respuestas},null,8,["autor","comentario-id","url","fecha","texto","respuestas"]))),128))]),_:1})):v("",!0),!n(u)&&!n(e).length?(a(),m("p",de,"No hay comentarios")):v("",!0)])])])])}}};export{_e as _};
